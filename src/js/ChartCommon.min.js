WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"ChartCommon",function(w){function A(a,b,c,e){function d(g){return c?b[g]:b[o-1-g]}function h(g){for(;d(g)[2]===t||d(g)[2]===x;)g--;return g}var q=j;if(e)q=k;var o=b.length;e=Math.floor(o/2);e=h(e);var u=0,y=o,l=false;if(d(0)[q]>a)return c?-1:o;if(d(o-1)[q]<a)return c?o:-1;for(;!l;){var i=e+1;if(i<o&&(d(i)[2]===t||d(i)[2]===x))i+=2;if(d(e)[q]>a){y=e;e=Math.floor((y+u)/2);e=h(e)}else if(d(e)[q]===a)l=true;else if(i<o&&d(i)[q]>a)l=true;else if(i<o&&d(i)[q]===
a){e=i;l=true}else{u=e;e=Math.floor((y+u)/2);e=h(e)}}return c?e:o-1-e}function D(a,b){return b[0][a]<b[b.length-1][a]}var t=2,x=3,j=0,k=1,B=this;w=w.WT.gfxUtils;var E=w.rect_top,F=w.rect_bottom,C=w.rect_left,G=w.rect_right,H=w.transform_mult;this.findClosestPoint=function(a,b,c){var e=j;if(c)e=k;var d=D(e,b);c=A(a,b,d,c);if(c<0)c=0;if(c>=b.length)return[b[b.length-1][j],b[b.length-1][k]];if(c>=b.length)c=b.length-2;if(b[c][e]===a)return[b[c][j],b[c][k]];var h=d?c+1:c-1;if(d&&b[h][2]==t)h+=2;if(!d&&
h<0)return[b[c][j],b[c][k]];if(!d&&h>0&&b[h][2]==x)h-=2;d=Math.abs(a-b[c][e]);a=Math.abs(b[h][e]-a);return d<a?[b[c][j],b[c][k]]:[b[h][j],b[h][k]]};this.minMaxY=function(a,b){b=b?j:k;for(var c=a[0][b],e=a[0][b],d=1;d<a.length;++d)if(a[d][2]!==t&&a[d][2]!==x&&a[d][2]!==5){if(a[d][b]>e)e=a[d][b];if(a[d][b]<c)c=a[d][b]}return[c,e]};this.projection=function(a,b){var c=Math.cos(a);a=Math.sin(a);var e=c*a,d=-b[0]*c-b[1]*a;return[c*c,e,e,a*a,c*d+b[0],a*d+b[1]]};this.distanceSquared=function(a,b){a=[b[j]-
a[j],b[k]-a[k]];return a[j]*a[j]+a[k]*a[k]};this.distanceLessThanRadius=function(a,b,c){return c*c>=B.distanceSquared(a,b)};this.toZoomLevel=function(a){return Math.floor(Math.log(a)/Math.LN2+0.5)+1};this.isPointInRect=function(a,b){var c;if(a.x!==undefined){c=a.x;a=a.y}else{c=a[0];a=a[1]}return c>=C(b)&&c<=G(b)&&a>=E(b)&&a<=F(b)};this.toDisplayCoord=function(a,b,c,e,d){if(c){a=[(a[j]-d[0])/d[2],(a[k]-d[1])/d[3]];e=[e[0]+a[k]*e[2],e[1]+a[j]*e[3]]}else{a=[(a[j]-d[0])/d[2],1-(a[k]-d[1])/d[3]];e=[e[0]+
a[j]*e[2],e[1]+a[k]*e[3]]}return H(b,e)};this.findYRange=function(a,b,c,e,d,h,q,o){if(a.length!==0){var u=B.toDisplayCoord([c,0],[1,0,0,1,0,0],d,h,q),y=B.toDisplayCoord([e,0],[1,0,0,1,0,0],d,h,q),l=d?k:j,i=d?j:k,g=D(l,a),f=A(u[l],a,g,d),m=A(y[l],a,g,d),n,p,r=Infinity,s=-Infinity,z=f===m&&f===a.length||f===-1&&m===-1;if(!z){if(g)if(f<0)f=0;else{f++;if(a[f]&&a[f][2]===t)f+=2}else if(f>=a.length-1)f=a.length-2;if(!g&&m<0)m=0;for(n=Math.min(f,m);n<=Math.max(f,m)&&n<a.length;++n)if(a[n][2]!==t&&a[n][2]!==
x){if(a[n][i]<r)r=a[n][i];if(a[n][i]>s)s=a[n][i]}if(g&&f>0||!g&&f<a.length-1){if(g){p=f-1;if(a[p]&&a[p][2]===x)p-=2}else{p=f+1;if(a[p]&&a[p][2]===t)p+=2}n=(u[l]-a[p][l])/(a[f][l]-a[p][l]);f=a[p][i]+n*(a[f][i]-a[p][i]);if(f<r)r=f;if(f>s)s=f}if(g&&m<a.length-1||!g&&m>0){if(g){g=m+1;if(a[g][2]===t)g+=2}else{g=m-1;if(a[g][2]===x)g-=2}n=(y[l]-a[m][l])/(a[g][l]-a[m][l]);f=a[m][i]+n*(a[g][i]-a[m][i]);if(f<r)r=f;if(f>s)s=f}}var v;a=q[2]/(e-c);c=d?2:3;if(!z){v=h[c]/(s-r);v=h[c]/(h[c]/v+20);if(v>o.y[b])v=o.y[b]}b=
d?[u[k]-E(h),!z?(r+s)/2-h[2]/v/2-C(h):0]:[u[j]-C(h),!z?-((r+s)/2+h[3]/v/2-F(h)):0];return{xZoom:a,yZoom:v,panPoint:b}}}});
