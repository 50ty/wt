WT_DECLARE_WT_MEMBER(10,JavaScriptConstructor,"WPaintedWidget",function(N,p){jQuery.data(p,"obj",this);var q=this;this.imagePreloaders=[];this.images=[];this.canvas=document.getElementById("c"+p.id);this.repaint=function(){};this.widget=p;this.cancelPreloaders=function(){for(var r=0;r<q.imagePreloaders.length;++r)q.imagePreloaders[r].cancel();q.imagePreloaders=[]}});
WT_DECLARE_WT_MEMBER(11,JavaScriptObject,"gfxUtils",function(){function N(){var h=this;this.path_crisp=function(a){return a.map(function(b){return[Math.floor(b[0])+0.5,Math.floor(b[1])+0.5,b[2]]})};this.transform_mult=function(a,b){if(b.length===2){var d=b[0],f=b[1];return[a[p]*d+a[q]*f+a[x],a[r]*d+a[v]*f+a[y]]}if(b.length===3){if(b[2]===D||b[2]===E)return b.slice(0);d=b[0];f=b[1];return[a[p]*d+a[q]*f+a[x],a[r]*d+a[v]*f+a[y],b[2]]}if(b.length===4){var g,e,c,l;e=h.transform_mult(a,[b[0],b[1]]);d=e[0];
g=e[0];f=e[1];e=e[1];for(c=0;c<3;++c){l=h.transform_mult(a,c==0?[h.rect_left(b),h.rect_bottom(b)]:c==1?[h.rect_right(b),h.rect_top(b)]:[h.rect_right(b),h.rect_bottom(b)]);d=Math.min(d,l[0]);g=Math.max(g,l[0]);f=Math.min(f,l[1]);e=Math.max(e,l[1])}return[d,f,g-d,e-f]}if(b.length===6)return[a[p]*b[p]+a[q]*b[r],a[p]*b[q]+a[q]*b[v],a[r]*b[p]+a[v]*b[r],a[r]*b[q]+a[v]*b[v],a[p]*b[x]+a[q]*b[y]+a[x],a[r]*b[x]+a[v]*b[y]+a[y]];return[]};this.transform_apply=function(a,b){var d=h.transform_mult;return b.map(function(f){return d(a,
f)})};this.transform_det=function(a){return a[p]*a[v]-a[q]*a[r]};this.transform_adjoint=function(a){var b=a[p],d=a[r],f=a[q],g=a[v],e=a[x];a=a[y];return[g,-d,-f,b,a*f-e*g,-(a*b-e*d)]};this.transform_inverted=function(a){var b=h.transform_det(a);if(b!=0){a=h.transform_adjoint(a);return[a[p]/b,a[r]/b,a[q]/b,a[v]/b,a[x]/b,a[y]/b]}else{console.log("inverted(): oops, determinant == 0");return a}};this.transform_assign=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]};this.transform_equal=
function(a,b){return a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]};this.css_text=function(a){return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"};this.arcPosition=function(a,b,d,f,g){g=-g/180*Math.PI;return[a+d*Math.cos(g),b+f*Math.sin(g)]};this.pnpoly=function(a,b){var d=false,f=0,g=0,e=a[0];a=a[1];var c,l,k;for(c=0;c<b.length;++c){l=f;k=g;if(b[c][2]===O){k=h.arcPosition(b[c][0],b[c][1],b[c+1][0],b[c+1][1],b[c+2][0]);l=k[0];k=k[1]}else if(b[c][2]===E){k=h.arcPosition(b[c-
2][0],b[c-2][1],b[c-1][0],b[c-1][1],b[c][0]+b[c][1]);l=k[0];k=k[1]}else if(b[c][2]!==D){l=b[c][0];k=b[c][1]}if(b[c][2]!==A)if(g>a!==k>a&&e<(l-f)*(a-g)/(k-g)+f)d=!d;f=l;g=k}return d};this.rect_intersection=function(a,b){a=h.rect_normalized(a);b=h.rect_normalized(b);var d=h.rect_top,f=h.rect_bottom,g=h.rect_left,e=h.rect_right;g=Math.max(g(a),g(b));e=Math.min(e(a),e(b));d=Math.max(d(a),d(b));a=Math.min(f(a),f(b));return[g,d,e-g,a-d]};this.drawRect=function(a,b,d,f){b=h.rect_normalized(b);var g=h.rect_top(b),
e=h.rect_bottom(b),c=h.rect_left(b);b=h.rect_right(b);path=[[c,g,A],[b,g,z],[b,e,z],[c,e,z],[c,g,z]];h.drawPath(a,path,d,f,false)};this.drawPath=function(a,b,d,f,g){function e(C){return C[0]}function c(C){return C[1]}function l(C){return C[2]}var k=0,n=[],m=[],o=[];a.beginPath();b.length>0&&l(b[0])!==A&&a.moveTo(0,0);for(k=0;k<b.length;k++){var i=b[k];switch(l(i)){case A:a.moveTo(e(i),c(i));break;case z:var j=k===0?[0,0]:[e(b[k-1]),c(b[k-1])],s=e(i)-e(j),u=c(i)-c(j),t=s>=0?1:-1,B=u>=0?1:-1;if(Math.abs(s)>
16777216||Math.abs(u)>16777216){var w=1,F=1;if(Math.abs(s)>Math.abs(u))F=Math.abs(u)/Math.abs(s);else w=Math.abs(s)/Math.abs(u);for(j=[e(j)+w*16777216*t,c(j)+F*16777216*B];t===1&&e(j)<e(i)||t===-1&&e(j)>e(i)||B===1&&c(j)<c(i)||B===-1&&c(j)>c(i);){a.lineTo(e(j),c(j));j=[e(j)+w*16777216*t,c(j)+F*16777216*B]}}a.lineTo(e(i),c(i));break;case T:n.push(e(i),c(i));break;case U:n.push(e(i),c(i));break;case G:n.push(e(i),c(i));a.bezierCurveTo.apply(a,n);n=[];break;case O:m.push(e(i),c(i));break;case D:m.push(e(i));
break;case E:m.push(e(i)*Math.PI/180,c(i)*Math.PI/180,c(i)>0);a.arc.apply(a,m);m=[];break;case V:o.push(e(i));break;case H:o.push(e(i),c(i));a.quadraticCurveTo.apply(a,o);o=[];break}}d&&a.fill();f&&a.stroke();g&&a.clip()};this.drawStencilAlongPath=function(a,b,d,f,g,e){function c(o){return o[0]}function l(o){return o[1]}function k(o){return o[2]}var n=0;for(n=0;n<d.length;n++){var m=d[n];if(!(e&&a.wtClipPath&&!h.pnpoly(m,h.transform_apply(a.wtClipPathTransform,a.wtClipPath))))if(k(m)==A||k(m)==z||
k(m)==H||k(m)==G){m=h.transform_apply([1,0,0,1,c(m),l(m)],b);h.drawPath(a,m,f,g,false)}}};this.drawText=function(a,b,d,f,g){if(!(g&&a.wtClipPath&&!h.pnpoly(g,h.transform_apply(a.wtClipPathTransform,a.wtClipPath)))){var e=d&I;var c=g=null;switch(d&W){case P:a.textAlign="left";g=h.rect_left(b);break;case Q:a.textAlign="right";g=h.rect_right(b);break;case S:a.textAlign="center";g=h.rect_center(b).x;break}switch(e){case J:a.textBaseline="top";c=h.rect_top(b);break;case K:a.textBaseline="bottom";c=h.rect_bottom(b);
break;case M:a.textBaseline="middle";c=h.rect_center(b).y;break}if(!(g==null||c==null)){b=a.fillStyle;a.fillStyle=a.strokeStyle;a.fillText(f,g,c);a.fillStyle=b}}};this.calcYOffset=function(a,b,d,f){return f===M?-((b-1)*d/2)+a*d:f===J?a*d:f===K?-(b-1-a)*d:0};this.drawTextOnPath=function(a,b,d,f,g,e,c,l,k){function n(w){return w[0]}function m(w){return w[1]}function o(w){return w[2]}var i=0,j=0;f=h.transform_apply(f,g);for(i=0;i<g.length;i++){if(i>=b.length)break;j=g[i];var s=f[i],u=b[i].split("\n");
if(o(j)==A||o(j)==z||o(j)==H||o(j)==G)if(e==0)for(j=0;j<u.length;j++){var t=h.calcYOffset(j,u.length,c,l&I);h.drawText(a,[d[0]+n(s),d[1]+m(s)+t,d[2],d[3]],l,u[j],k?[n(s),m(s)]:null)}else{t=e*Math.PI/180;j=Math.cos(-t);t=-Math.sin(-t);var B=-t;a.save();a.transform(j,B,t,j,n(s),m(s));for(j=0;j<u.length;j++){t=h.calcYOffset(j,u.length,c,l&I);h.drawText(a,[d[0],d[1]+t,d[2],d[3]],l,u[j],k?[n(s),m(s)]:null)}a.restore()}}};this.setClipPath=function(a,b,d,f){if(f){a.setTransform.apply(a,d);h.drawPath(a,b,
false,false,true);a.setTransform(1,0,0,1,0,0)}a.wtClipPath=b;a.wtClipPathTransform=d};this.removeClipPath=function(a){delete a.wtClipPath;delete a.wtClipPathTransform};this.rect_top=function(a){return a[1]};this.rect_bottom=function(a){return a[1]+a[3]};this.rect_right=function(a){return a[0]+a[2]};this.rect_left=function(a){return a[0]};this.rect_topleft=function(a){return[a[0],a[1]]};this.rect_topright=function(a){return[a[0]+a[2],a[1]]};this.rect_bottomleft=function(a){return[a[0],a[1]+a[3]]};
this.rect_bottomright=function(a){return[a[0]+a[2],a[1]+a[3]]};this.rect_center=function(a){return{x:(2*a[0]+a[2])/2,y:(2*a[1]+a[3])/2}};this.rect_normalized=function(a){var b,d,f;if(a[2]>0){b=a[0];f=a[2]}else{b=a[0]+a[2];f=-a[2]}if(a[3]>0){d=a[1];a=a[3]}else{d=a[1]+a[3];a=-a[3]}return[b,d,f,a]}}var p=0,q=1,r=2,v=3,x=4,y=5,A=0,z=1,T=2,U=3,G=4,V=5,H=6,O=7,D=8,E=9,P=1,Q=2,S=4,J=128,M=512,K=1024,I=112|J|256|M|K|2048,W=P|Q|S|8;return new N}());
